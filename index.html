<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>The Selah Radio — Login Required</title>
<style>
/* Fallback fonts and no CSS variables for old browsers */
html,body{height:100%;margin:0;font-family:Arial,Helvetica,sans-serif;background:#3b0b0b;color:#fff;}
/* Modern browsers will override with vars */
:root{
  --bg1:#3b0b0b; --bg2:#7a1f2b; --accent:#d4a017;
  --muted:rgba(242,236,230,0.78); --text:#fff8f2;
  font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
}
body{
  background:#3b0b0b;
  background:
    radial-gradient(1000px 500px at 10% 10%, rgba(212,160,23,0.06), transparent 8%),
    linear-gradient(180deg,var(--bg1,#3b0b0b),var(--bg2,#7a1f2b));
  color:var(--text,#fff);
  -webkit-font-smoothing:antialiased;
  display:flex;align-items:center;justify-content:center;padding:22px;
}
.container{width:100%;max-width:920px;text-align:center;padding:34px;}
header{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;}
.left{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}
.logo{width:64px;height:64px;border-radius:12px;background:#2a0a0a;display:flex;align-items:center;justify-content:center;}
h1{margin:0;font-size:1.45rem;font-weight:700;color:var(--text,#fff);}
.subtitle{color:var(--muted,#ccc);font-size:0.95rem;}
.clock{margin-top:18px;}
.time{font-size:3.6rem;margin:0;font-weight:800;letter-spacing:1px;}
.ampm,.date{color:var(--muted,#ccc);font-size:1rem;}
.verse{margin-top:18px;padding:20px;border-radius:10px;background:#2a0a0a;color:var(--muted,#ccc);}
.verse .quote{font-style:italic;color:var(--text,#fff);font-size:1.1rem;margin-bottom:10px;}
.verse .ref{color:var(--accent,#d4a017);font-weight:bold;}
.login-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;z-index:3000;}
.login-card{width:100%;max-width:400px;background:#2a0a0a;color:var(--muted,#ccc);padding:20px;border-radius:10px;}
.field{margin-bottom:12px;text-align:left;}
input[type=text],input[type=password]{width:100%;padding:10px;border-radius:8px;border:1px solid #444;background:#111;color:#fff;}
button{cursor:pointer;}
button.primary{background:var(--accent,#d4a017);color:#000;padding:10px 14px;border:0;border-radius:8px;font-weight:bold;}
button.ghost{background:transparent;color:var(--muted,#ccc);border:0;padding:8px;}
.play-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.45);display:flex;align-items:center;justify-content:center;z-index:1600;}
.play-pill{background:var(--accent,#d4a017);color:#000;padding:18px 26px;border-radius:999px;font-weight:bold;cursor:pointer;}
.yt-hidden{position:absolute;left:-9999px;top:-9999px;width:1px;height:1px;overflow:hidden;}
</style>
</head>
<body>
<div class="container" id="appContent" aria-hidden="true">
  <header>
    <div class="left">
      <div class="logo">
        <svg viewBox="0 0 100 100" width="56" height="56" xmlns="http://www.w3.org/2000/svg">
          <circle cx="50" cy="50" r="46" fill="#7a1f2b"/>
          <circle cx="50" cy="50" r="40" fill="#d4a017" opacity="0.07"/>
          <path d="M36 30 C48 14, 70 18, 66 34 C62 50, 44 50, 48 66 C52 82, 74 78, 64 58"
           fill="none" stroke="#fff" stroke-width="5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="title">
        <h1>The Selah Radio</h1>
        <div class="subtitle">A gentle moment of scripture and stillness — login to begin</div>
      </div>
    </div>
  </header>
  <section class="clock">
    <div id="time" class="time">--:--:--</div>
    <div id="ampm" class="ampm">--</div>
    <div id="date" class="date">Loading date...</div>
  </section>
  <section class="verse">
    <div id="verseQuote" class="quote">Loading verse…</div>
    <div id="verseRef" class="ref"></div>
  </section>
</div>

<div class="login-overlay" id="loginOverlay">
  <div class="login-card">
    <h2>Sign in to access The Selah Radio</h2>
    <div id="messages"></div>
    <div id="loginForm">
      <div class="field">
        <label>Username</label>
        <input id="loginUser" type="text" />
      </div>
      <div class="field">
        <label>Password</label>
        <input id="loginPass" type="password" />
      </div>
      <button id="doLogin" class="primary">Sign in</button>
      <button id="showRegister" class="ghost">Create account</button>
    </div>
    <div id="registerForm" style="display:none;">
      <div class="field"><label>Choose username</label><input id="regUser" type="text"></div>
      <div class="field"><label>Choose password</label><input id="regPass" type="password"></div>
      <div class="field"><label>Confirm password</label><input id="regPass2" type="password"></div>
      <button id="doRegister" class="primary">Create account</button>
      <button id="showLogin" class="ghost">Back to sign in</button>
    </div>
  </div>
</div>

<div id="playOverlay" class="play-overlay" style="display:none;">
  <div class="play-pill" id="playButton">Play Live Audio</div>
</div>
<div id="ytHidden" class="yt-hidden"></div>

<script>
// Safe storage
function safeGet(key){try{return localStorage.getItem(key)}catch(e){return null}}
function safeSet(key,v){try{localStorage.setItem(key,v)}catch(e){}}
function safeRem(key){try{localStorage.removeItem(key)}catch(e){}}
// Fallback SHA-256 simple (not secure, but works in IE11)
function sha256(str){if(window.crypto&&crypto.subtle){return crypto.subtle.digest("SHA-256",new TextEncoder().encode(str)).then(b=>Array.from(new Uint8Array(b)).map(x=>x.toString(16).padStart(2,"0")).join(""))}return Promise.resolve(str)}
async function createUser(u,p){const users=JSON.parse(safeGet("users")||"{}");if(users[u])throw new Error("taken");users[u]={hash:await sha256(p)};safeSet("users",JSON.stringify(users))}
async function verifyUser(u,p){const users=JSON.parse(safeGet("users")||"{}");if(!users[u])return false;return (await sha256(p))===users[u].hash}
// UI
const loginOverlay=document.getElementById("loginOverlay");
document.getElementById("doLogin").onclick=async()=>{const u=document.getElementById("loginUser").value,p=document.getElementById("loginPass").value;if(await verifyUser(u,p)){loginOverlay.style.display="none";document.getElementById("appContent").removeAttribute("aria-hidden");document.getElementById("playOverlay").style.display="flex"}else alert("Invalid")};
document.getElementById("doRegister").onclick=async()=>{const u=document.getElementById("regUser").value,p=document.getElementById("regPass").value,p2=document.getElementById("regPass2").value;if(p!==p2)return alert("Mismatch");try{await createUser(u,p);alert("Created");document.getElementById("registerForm").style.display="none";document.getElementById("loginForm").style.display="block"}catch(e){alert("Error:"+e.message)}};
document.getElementById("showRegister").onclick=()=>{document.getElementById("loginForm").style.display="none";document.getElementById("registerForm").style.display="block"};
document.getElementById("showLogin").onclick=()=>{document.getElementById("registerForm").style.display="none";document.getElementById("loginForm").style.display="block"};
// clock
function tick(){const d=new Date();document.getElementById("time").textContent=d.toLocaleTimeString();document.getElementById("ampm").textContent=d.getHours()>=12?"PM":"AM";document.getElementById("date").textContent=d.toDateString()}setInterval(tick,1000);tick();
// verse
const verses=[{reference:"Philippians 4:13",text:"I can do all things through Christ who strengthens me."},{reference:"Psalm 23:1",text:"The LORD is my shepherd; I shall not want."}];
function showVerse(){const v=verses[Math.floor(Math.random()*verses.length)];document.getElementById("verseQuote").textContent=v.text;document.getElementById("verseRef").textContent=v.reference}
setInterval(showVerse,60000);showVerse();
</script>
</body>
</html>
