<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Daily Inspiration — Christian Clock</title>
  <style>
    :root{
      --bg1:#283a6b; --bg2:#5b65c7; --accent:#ffd166;
      --muted: rgba(230,238,246,0.78); --text:#ffffff;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
    }
    html,body{height:100%;margin:0}
    body{
      display:flex; align-items:center; justify-content:center;
      background: linear-gradient(180deg,var(--bg1),var(--bg2));
      color:var(--text); padding:18px;
    }
    .container{ width:100%; max-width:820px; text-align:center; padding-bottom:110px; }
    header{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .title { text-align:left; }
    h1{ margin:0; font-size:1.6rem; font-weight:600; color:var(--text); }
    .subtitle{ margin-top:6px; color:var(--muted); font-size:0.95rem; }
    .login-area{ display:flex; gap:8px; align-items:center; }
    .small-btn{ background:rgba(255,255,255,0.06); padding:8px 10px; border-radius:10px; color:var(--text); cursor:pointer; font-weight:700; border:0; }
    .small-btn.disabled{ opacity:0.45; cursor:default; }
    .g-icon{ width:18px; height:18px; vertical-align:middle; margin-right:8px; }
    .fb-icon{ width:18px; height:18px; vertical-align:middle; margin-right:8px; }

    .greeting{ margin-top:16px; text-align:left; color:var(--muted); }
    .greeting strong{ color:var(--text); }

    .clock{ margin-top:18px; text-align:center; }
    .time{ font-size:4.2rem; margin:0; line-height:1; font-weight:700; letter-spacing:1px; }
    .ampm{ font-size:1.05rem; color:var(--muted); margin-top:6px; }
    .date{ margin-top:12px; color:var(--muted); font-size:1rem; }

    .verse{ margin-top:18px; background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02)); border-radius:14px; padding:22px 18px; box-shadow: 0 10px 30px rgba(2,6,23,0.45); color:var(--muted); text-align:center; }
    .verse .quote{ font-style:italic; color:var(--text); font-size:1.08rem; line-height:1.6; margin:0 0 12px 0; }
    .verse .ref{ color:var(--accent); font-weight:700; font-size:0.98rem; }

    /* Centered big Play overlay */
    .overlay { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background: rgba(10,12,20,0.45); z-index:1200; transition: opacity .25s ease; }
    .play-pill{ background:var(--accent); color:#04111a; border-radius:999px; padding:18px 24px; font-weight:800; font-size:1.05rem; cursor:pointer; box-shadow:0 10px 30px rgba(2,6,23,0.6); }
    .play-sub{ display:block; font-weight:600; font-size:0.84rem; margin-top:8px; color:#04111a; opacity:0.9 }

    /* Hidden iframe container */
    .yt-hidden{ position:fixed; left:-9999px; top:-9999px; width:1px; height:1px; overflow:hidden; }

    /* Bottom fallback */
    .bottom-player{ position:fixed; left:12px; right:12px; bottom:12px; z-index:1201; display:none; justify-content:center; }
    .player-bar{ background: rgba(0,0,0,0.5); padding:10px 14px; border-radius:999px; display:flex; gap:10px; align-items:center; color:var(--muted); backdrop-filter: blur(6px); max-width:720px; width:calc(100% - 24px); }
    .player-bar button{ background:var(--accent); color:#04111a; border:0; padding:8px 14px; border-radius:999px; font-weight:700; cursor:pointer; }

    @media (max-width:560px){ .time{ font-size:3rem } .play-pill{ padding:14px 18px; font-size:1rem } }
  </style>
</head>
<body>
  <div class="container" role="main">
    <header>
      <div class="title">
        <h1>Daily Inspiration</h1>
        <div class="subtitle">Let His word guide your day</div>
      </div>

      <div class="login-area" id="loginArea" aria-hidden="false">
        <!-- GOOGLE / FACEBOOK buttons -->
        <button id="googleBtn" class="small-btn" title="Sign in with Google">
          <img class="g-icon" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23EA4335' d='M24 9.5c3.9 0 7 1.4 9.1 3.1l6.8-6.8C35.9 2.3 30.5 0 24 0 14 0 5.5 5.9 1.9 14.4l7.9 6.1C11.9 12 17.4 9.5 24 9.5z'/%3E%3Cpath fill='%234285F4' d='M46.5 24.5c0-1.6-.1-3.2-.4-4.7H24v9h12.7c-.6 3-2.6 5.4-5.5 7l8.4 6.5C43.4 38.1 46.5 31.9 46.5 24.5z'/%3E%3Cpath fill='%23FBBC05' d='M8.2 29.6A14.7 14.7 0 0 1 7 24.5c0-1.6.3-3.2.9-4.6L1.9 13.8C.7 16.9 0 20.6 0 24.5c0 3.9.7 7.6 1.9 10.7l6.3-5.6z'/%3E%3Cpath fill='%2327A757' d='M24 48c6.5 0 12-2.2 16.1-6l-8.4-6.5c-2.3 1.6-5.2 2.6-7.7 2.6-6.6 0-12.1-3.4-15-8.4L1.9 34.6C5.5 42.1 14 48 24 48z'/%3E%3C/svg%3E" alt="G"/>
          Google
        </button>

        <button id="fbBtn" class="small-btn" title="Sign in with Facebook">
          <img class="fb-icon" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%231A73E8' d='M22 12a10 10 0 1 0-11.5 9.9v-7h-2.2V12h2.2V9.6c0-2.2 1.3-3.4 3.2-3.4.9 0 1.8.2 1.8.2v2h-1c-1 0-1.3.6-1.3 1.2V12h2.3l-.4 2.9h-1.9v7A10 10 0 0 0 22 12z'/%3E%3C/svg%3E" alt="F"/>
          Facebook
        </button>
      </div>
    </header>

    <div class="greeting" id="greeting" style="display:none;">
      <div id="greetingText"></div>
      <div style="font-size:0.9rem;color:var(--muted)">Timezone: <span id="tzName"></span></div>
    </div>

    <section class="clock" aria-live="polite">
      <div id="time" class="time">--:--:--</div>
      <div id="ampm" class="ampm">--</div>
      <div id="date" class="date">Loading date...</div>
    </section>

    <section class="verse" aria-label="Verse of the minute">
      <div id="verseQuote" class="quote">Loading verse…</div>
      <div id="verseRef" class="ref"></div>
    </section>
  </div>

  <!-- Hidden offscreen iframe target for audio-only playback -->
  <div id="ytHidden" class="yt-hidden" aria-hidden="true"></div>

  <!-- Big centered Play overlay -->
  <div id="overlay" class="overlay" role="dialog" aria-modal="true" aria-label="Tap to play audio">
    <div style="text-align:center">
      <div id="playButton" class="play-pill" role="button" aria-pressed="false">
        Play Live Audio
        <span class="play-sub">Tap once to start audio with sound</span>
      </div>
    </div>
  </div>

  <!-- Bottom fallback player -->
  <div class="bottom-player" id="bottomPlayer">
    <div class="player-bar" role="region" aria-label="Player controls">
      <button id="fallbackPlay">Play</button>
      <small id="playerNote" style="color:var(--muted)">Tap to enable audio if needed</small>
    </div>
  </div>

  <script>
    /******************************************************************
     * Configuration - Replace these with your real credentials:
     ******************************************************************/
    const GOOGLE_CLIENT_ID = "YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com"; // <-- replace
    const FB_APP_ID = "YOUR_FACEBOOK_APP_ID"; // <-- replace

    /******************************************************************
     * Verse and Clock (unchanged core behaviour)
     ******************************************************************/
    const baseVerses = [
      {"reference":"Philippians 4:13","text":"I can do all things through Christ who strengthens me."},
      {"reference":"Psalm 23:1","text":"The LORD is my shepherd; I shall not want."},
      {"reference":"John 3:16","text":"For God so loved the world, that he gave his only begotten Son..."},
      {"reference":"Proverbs 3:5","text":"Trust in the LORD with all your heart and lean not on your own understanding."},
      {"reference":"Romans 8:28","text":"And we know that all things work together for good to those who love God."},
      {"reference":"Isaiah 40:31","text":"But they who wait for the LORD shall renew their strength."}
    ];
    const WANT = 1440;
    let minuteVerses = [];
    function buildMinuteVerses(){
      minuteVerses = [];
      if (!baseVerses || baseVerses.length === 0) return;
      let i = 0;
      while (minuteVerses.length < WANT){
        minuteVerses.push(baseVerses[i % baseVerses.length]);
        i++;
      }
    }

    function pad(n){ return String(n).padStart(2,'0'); }

    function updateClockOnce(){
      const now = new Date();
      let h = now.getHours();
      const ampm = h >= 12 ? 'PM' : 'AM';
      let hr12 = h % 12; hr12 = hr12 === 0 ? 12 : hr12;
      document.getElementById('time').textContent = `${pad(hr12)}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;
      document.getElementById('ampm').textContent = ampm;
      const opts = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      document.getElementById('date').textContent = now.toLocaleDateString(undefined, opts);
    }

    function renderVerseForMinute(idx){
      if (!minuteVerses || minuteVerses.length === 0) return;
      const v = minuteVerses[idx % minuteVerses.length];
      document.getElementById('verseQuote').textContent = `"${v.text}"`;
      document.getElementById('verseRef').textContent = v.reference || '';
    }

    function scheduleClockAndVerses(){
      updateClockOnce();
      renderVerseForMinute(new Date().getHours()*60 + new Date().getMinutes());
      setInterval(updateClockOnce, 1000); // seconds tick
      const now = new Date();
      const msToNextMinute = (60 - now.getSeconds())*1000 - now.getMilliseconds();
      setTimeout(() => {
        renderVerseForMinute(new Date().getHours()*60 + new Date().getMinutes());
        setInterval(() => renderVerseForMinute(new Date().getHours()*60 + new Date().getMinutes()), 60*1000);
      }, msToNextMinute);
    }

    buildMinuteVerses();
    scheduleClockAndVerses();

    /******************************************************************
     * Login: Google (client-side) using Google Identity Services
     * and Facebook JS SDK (client-side). Both are optional: replace
     * the placeholders above to enable them.
     ******************************************************************/
    const googleBtn = document.getElementById('googleBtn');
    const fbBtn = document.getElementById('fbBtn');
    const greetingEl = document.getElementById('greeting');
    const greetingText = document.getElementById('greetingText');
    const tzNameEl = document.getElementById('tzName');

    // Detect timezone
    function userTimeZone(){ try { return Intl.DateTimeFormat().resolvedOptions().timeZone || 'UTC'; } catch(e){ return 'UTC'; } }
    tzNameEl.textContent = userTimeZone();

    // Compose greeting by local hour
    function greetWithName(name){
      const now = new Date();
      const hour = now.getHours();
      let part = hour < 12 ? 'Good Morning' : (hour < 18 ? 'Good Afternoon' : 'Good Evening');
      greetingEl.style.display = 'block';
      greetingText.innerHTML = `${part}, glad to see you <strong>${escapeHtml(name)}</strong>!`;
    }

    // Simple HTML-escape
    function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c=>'&#'+c.charCodeAt(0)+';'); }

    // GOOGLE: client-side sign-in
    if (GOOGLE_CLIENT_ID && !GOOGLE_CLIENT_ID.includes("YOUR_GOOGLE_CLIENT_ID")) {
      // insert Google Identity Services script
      const gScript = document.createElement('script');
      gScript.src = "https://accounts.google.com/gsi/client";
      gScript.async = true;
      document.head.appendChild(gScript);

      // Render a lightweight button using the library when loaded
      gScript.onload = () => {
        try {
          google.accounts.id.initialize({
            client_id: GOOGLE_CLIENT_ID,
            callback: handleGoogleCredential
          });
          // render an invisible button into our custom button (so we reuse styling)
          const wrapper = document.createElement('div');
          google.accounts.id.renderButton(wrapper, { theme: "outline", size: "small" });
          // attach click to existing styled button to prompt the Google UX
          googleBtn.addEventListener('click', () => {
            google.accounts.id.prompt(); // this triggers One Tap / credential UX
            // Also try to show a popup sign-in (works if user has no One Tap)
            // Note: the modern recommended flow is prompt()/credential. For simple profile name, the credential callback is enough.
          });
        } catch(e){
          console.warn('Google init failed', e);
          googleBtn.classList.add('disabled');
          googleBtn.title = "Requires valid Google client ID (configure in the file)";
        }
      };
    } else {
      // disable button and show hint
      googleBtn.classList.add('disabled');
      googleBtn.addEventListener('click', () => {
        alert('To enable Google Sign-In, replace GOOGLE_CLIENT_ID at the top of this file with your OAuth 2.0 Client ID from Google Cloud.');
      });
    }

    function handleGoogleCredential(response){
      try {
        // response.credential is a JWT. Decode payload to read name.
        const jwt = response.credential || '';
        const payload = JSON.parse(atob(jwt.split('.')[1].replace(/-/g,'+').replace(/_/g,'/')));
        const name = payload.name || payload.email || 'Friend';
        greetWithName(name);
      } catch(e){
        console.warn('failed to parse Google credential', e);
      }
    }

    // FACEBOOK: client-side login
    if (FB_APP_ID && !FB_APP_ID.includes("YOUR_FACEBOOK_APP_ID")) {
      // load FB SDK
      window.fbAsyncInit = function() {
        FB.init({
          appId      : FB_APP_ID,
          cookie     : true,
          xfbml      : false,
          version    : 'v16.0'
        });
      };
      // load SDK script
      (function(d, s, id){
        if (d.getElementById(id)) return;
        var js = d.createElement(s); js.id = id;
        js.src = "https://connect.facebook.net/en_US/sdk.js";
        d.head.appendChild(js);
      }(document, 'script', 'facebook-jssdk'));

      fbBtn.addEventListener('click', () => {
        // request public profile
        FB.login(function(response) {
          if (response.authResponse) {
            FB.api('/me', {fields: 'name'}, function(profile){
              greetWithName(profile.name || 'Friend');
            });
          } else {
            console.warn('User cancelled Facebook login or did not fully authorize.');
          }
        }, {scope: 'public_profile,email'});
      });
    } else {
      fbBtn.classList.add('disabled');
      fbBtn.addEventListener('click', () => {
        alert('To enable Facebook Sign-In, replace FB_APP_ID at the top of this file with your Facebook App ID.');
      });
    }

    /******************************************************************
     * Audio (unmuted) — single user gesture: create offscreen unmuted iframe
     ******************************************************************/
    // Your YouTube live video id (from the link you provided)
    const YT_ID = '_QqFhkOcljI';

    function createAudioIframeUnmuted(){
      const container = document.getElementById('ytHidden');
      if (container.querySelector('iframe')) return true;
      const iframe = document.createElement('iframe');
      iframe.src = `https://www.youtube.com/embed/${YT_ID}?autoplay=1&mute=0&playsinline=1&rel=0&modestbranding=1`;
      iframe.allow = 'autoplay; encrypted-media';
      iframe.width = '1'; iframe.height = '1'; iframe.style.border='0';
      container.appendChild(iframe);
      return true;
    }

    // Big primary play overlay
    const overlay = document.getElementById('overlay');
    const playButton = document.getElementById('playButton');
    const bottomPlayer = document.getElementById('bottomPlayer');
    const fallbackPlay = document.getElementById('fallbackPlay');

    playButton.addEventListener('click', () => {
      try {
        createAudioIframeUnmuted(); // user gesture -> allows audible playback
        overlay.style.opacity = '0';
        setTimeout(()=> overlay.style.display='none', 220);
      } catch(err){
        console.warn('play failed', err);
        overlay.style.display='none';
        bottomPlayer.style.display='flex';
      }
    });

    fallbackPlay.addEventListener('click', () => {
      try {
        createAudioIframeUnmuted();
        bottomPlayer.style.display='none';
      } catch (e) {
        window.open(`https://www.youtube.com/live/${YT_ID}`, '_blank');
      }
    });

    overlay.addEventListener('click', (ev) => {
      if (ev.target === overlay) {
        overlay.style.display = 'none';
        bottomPlayer.style.display = 'flex';
      }
    });

    /******************************************************************
     * Small helpers & accessibility
     ******************************************************************/
    // allow Enter/Space on playButton
    playButton.tabIndex = 0;
    playButton.addEventListener('keydown', (ev) => {
      if (ev.key === 'Enter' || ev.key === ' ') { ev.preventDefault(); playButton.click(); }
    });

    // show timezone immediately in header
    document.getElementById('tzName').textContent = userTimeZone();

    // Done.
  </script>
</body>
</html>
